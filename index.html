<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
   <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
  <title>GreySpot</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <script src="javascript/api.js"></script>

</head>
<body>
  <div id="waveform"></div>
  <div id='banner'>
    <div id= 'blur'></div>

    <img src='images/photo1.jpg'/>
  </div>
    <div id="meta"></div>
  <div id="slider">

    <div id="songs"></div>

  </div>
<div id="box"></div>
 <iframe id='grey' width="30%" height="80%" scrolling="yes" frameborder="no" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/users/3916568"></iframe>
 <footer>@Contact Info</footer>

  <img src='images/Facebook.png' id='facebook'/>
  <img src='images/Instagram.png' id='instagram'/>
  <img src='images/YouTube.png' id='youtube'/>
  <img src='images/Twitter.png' id='twitter'/>
  <img src='images/soundcloud.png' id='soundCloud'/>

<script>

 var blur = document.getElementById('blur');
    var img = new Image();
    img.src = "images/wave1.png";
    var widget = SC.Widget(document.getElementById('grey'));
    //var sound = document.getElementById('sound');
   
    var waveform = document.getElementById('waveform');
    waveform.appendChild(img);
    var slider = document.getElementById('slider');
    var songs = document.getElementById('songs');
    var meta = document.getElementById('meta');
   // var blur = document.getElementById('blur');
/*
   var media = video.getClientRects()[0];
   var mediaTop = media.top;
   var mediaLeft = media.left;
   var mediaBottom = media.bottom;
   var mediaRight = media.right;
   var mediaWidth = media.width;
   var tenPercent = (media.width * 0.1).toFixed(0);
   */

(function() {
        var mousePos;
        //banner.onmouseover = handleMouseMove;
        window.onmousemove = handleMouseMove;
        //setInterval(getMousePosition, 100); // setInterval repeats every X ms

        function handleMouseMove(event) {
            event = event || window.event; // IE-ism
            mousePos = {
                x: event.clientX,
                y: event.clientY
            };
            
              console.log(mousePos.x, mousePos.y);
            
          }
        
        

    })();
   

    widget.bind(SC.Widget.Events.READY, function() {
      widget.getSounds(function(data) {
        for (var i = 0; i < 7; i++) {
          console.log(data[i].title, data[i].artwork_url);
          var waveform = data[i].waveform_url;
          var song = new Image();
          song.src = data[i].artwork_url;
          var el = document.createElement("div");
          var title = document.createElement("p");
          var text = document.createTextNode(data[i].title);
          title.appendChild(text);
          el.id = "song_" + i;
          el.value = i;
          el.setAttribute('name',data[i].title)
          el.setAttribute('wave',waveform);
          //this.el.onclick = skip(i);
          el.appendChild(title);
          el.appendChild(song);
          //var width = el.clientWidth;
          //el.style.position = "absolute";
          el.style.left = 100*i + "%";
          songs.appendChild(el);
          el.addEventListener('click', function(event) {
            event.stopPropagation();
            widget.skip(this.value);
            //img.src = this.getAttribute('wave');
            //meta.innerHTML = this.getAttribute('name');
            }, false);
        }
        console.log(this);
        console.log(data[0].waveform_url);
        
        //img.src = data[0].waveform_url;
        //video.appendChild(img);
        //two.src = data[1].waveform_url;
      });
    });
    function whatever() {this.el.addEventListener('click', function(event) {
          event.stopPropagation();
          widget.skip(this.value);
          widget.play();
          }, false);
}
    function skip() {
      var songs = video.getElementsByTagName('div');
      //console.log(songs);
      for (var i = 0; i < songs.length; i++) {
          this.song = songs[i];
          this.song.addEventListener("click", function(event) {
          event.stopPropagation();
          widget.skip(i);
        },false)
        console.log(i);
      }
    }
var timer;
var count = true;
    function bindIt() {
        //widget.bind(SC.Widget.Events.PLAY_PROGRESS, function(data) {
          //console.log(data.relativePosition);
        //});
        widget.bind(SC.Widget.Events.PLAY, function(data) {
          console.log(data.relativePosition);
          banner.style.webkitAnimation = "weird 1s infinite";
          banner.style.webkitAnimationPlayState = "running";
        });

        widget.bind(SC.Widget.Events.PAUSE, function(data) {
          console.log(data.relativePosition);
          banner.style.webkitAnimationPlayState = "paused";
          banner.style.webkitFilter = "invert(0%)"
        });
      };
      widget.bind(SC.Widget.Events.PLAY_PROGRESS, function(data) {
        blur.style.width = data.relativePosition*64 + "%";
          if (count) {
            timer = data.currentPosition.toPrecision(2);
            count = false;
          }
          if (timer != data.currentPosition.toPrecision(2)) {
             console.log(timer);
             count=true;
          }

      });

      widget.bind(SC.Widget.Events.PLAY, function(data) {
        widget.getCurrentSound(function(data) {
          meta.innerHTML = data.title;
          img.src = data.waveform_url;
        });
      });
  </script>
</body>
</html>
